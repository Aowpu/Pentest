## Giới thiệu về Java Object Injection
### Serialize
- Java cung cấp cho người dùng hàm writeObject để serialize các object. [Link](https://docs.oracle.com/javase/7/docs/api/java/io/ObjectOutputStream.html)
### Deserialize
- Để có thể đọc được dữ liệu đã được serialized từ ObjectInputStream ta sử
dụng hàm `readObject`. [Link](https://docs.oracle.com/javase/7/docs/api/java/io/ObjectInputStream.html)
### Serialize data trong Java
- Khi serialize data được nằm trong file `.bin` bao gồm các thành phần mình có thể nhìn thấy như:
  + File signature
  ![image](https://github.com/Aowpu/Pentest/assets/130723782/599bd4d0-28fb-4fd2-98af-eaab2f3f43b3)
  + Class name
  ![image](https://github.com/Aowpu/Pentest/assets/130723782/df140197-047c-405f-a61d-a4a796079c18)
  + Tên thuộc tính
  ![image](https://github.com/Aowpu/Pentest/assets/130723782/d21bf306-874b-4509-b346-66d25275a3fc)
  + Kiểu dữ liệu của thuộc tính
  ![image](https://github.com/Aowpu/Pentest/assets/130723782/9a3c6ad7-6406-4957-bc93-833a609fb697)
  + Giá trị của thuộc tính
  ![image](https://github.com/Aowpu/Pentest/assets/130723782/5a51b39b-9713-42c9-80cd-971db9ad32cc)
  + SERIAL VERSION UID (Mỗi class sẽ có SERIAL VERSION UID khác nhau và Khi deserialize java sẽ kiểm tra nó để đảm bảo sự tương thích)
  ![image](https://github.com/Aowpu/Pentest/assets/130723782/23be4a06-86fc-4648-856d-88d8e73f4b5e)
## Khai thác Java Object Injection
- Chú ý đến các đối tượng deserialize untrusted data.
- Tận dụng các magic method, cách vận hành của OOP để tạo ra một exploit chain hoàn chỉnh.
###  Java’s Magic method
- Những magic method phổ biến
  - classname() : 
  - finelize() : Phương thức này được gọi bởi trình thu gom rác trước khi lấy lại bộ nhớ mà đối tượng đã chiếm giữ.
  - toString() : Phương thức này trả về một chuỗi biểu diễn của một đối tượng.
### Tùy chỉnh quá trình Serialize và Deserialize
- Viết lại các method writeObject(), readObject()
## Tổng kết
- Root cause: Untrusted data rơi vào quá trình unserialize
- Impact: Tạo được một Object theo ý mình muốn
  - Thay đổi thuộc tính
  - Thay đổi class
  - Tận dụng các method xây dựng POP chain tạo ra luồn thực thi mới
- Context: readObject (Untrustedata)
## Các bài lab mình đã làm về lỗ hổng này
[Lab Cyberjutsu](https://hackmd.io/@AowPhwc/ByM5XvPAp)
