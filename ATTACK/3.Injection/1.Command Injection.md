# Command Injection
## Command Injection vulnerability là gì
- Command Injection vulnerability là là một lỗ hổng bảo mật web cho phép kẻ tấn công có thể thực thi các lệnh hệ thống trên máy chủ đó khi đang chạy 1 dịch vụ nào đó.
- Command injection có nhiều dạng khác nhau. Bao gồm thực hiện trực tiếp lệnh shell, đưa các file độc hại vào môi trường runtime của server và khai thác lỗ hổng trong các file config.
## Tổng quan về lỗ hổng này
- Root cause: Sự nhầm lẫn giữa của hệ thống giữa user input và command
- Impact: Chạy đưuọc OS Command trên server
- Context: Untrusted data rơi vào hàm thực thi OS Command
  - PHP: system(), exec(), passthru(),...  
## Một số bài viết tham khảo
- [Hacktricks](https://book.hacktricks.xyz/pentesting-web/command-injection)
- [PortSwigger](https://portswigger.net/web-security/os-command-injection)
- [OSWAP](https://owasp.org/www-community/attacks/Command_Injection)

## Demo lab về lỗ hổng Command Injection
1. [Lab Cyberjutsu](https://hackmd.io/@AowPhwc/SJxrlfeAT)
2. [Lab Cyberjutsu khi có các regex](https://hackmd.io/@AowPhwc/HyHmbTg0T)
## Tổng kết sau khi làm Lab
- Nên có các regex phù hợp hơn hoặc để whilelist
- Tránh gọi trực tiếp câu lệnh đến hệ điều hành

